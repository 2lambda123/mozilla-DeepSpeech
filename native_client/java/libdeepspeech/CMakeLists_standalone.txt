cmake_minimum_required(VERSION 3.10)

set(JAVA_AWT_INCLUDE_PATH NotNeeded)

set(JAVA_HOME __JAVA_HOME__)

find_package(Java REQUIRED)
find_package(JNI REQUIRED)
include(UseJava)

include_directories( ${CMAKE_JAVA_} __JAVA_HOME__/include __JAVA_HOME__/include/linux )

add_library( deepspeech-jni SHARED ../jni/deepspeech_wrap.cpp )

find_library(deepspeech-lib NAMES deepspeech PATHS ${CMAKE_SOURCE_DIR}/libs/ REQUIRED)
message(STATUS ${deepspeech-lib})

add_custom_command( TARGET deepspeech-jni POST_BUILD COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_SOURCE_DIR}/libs/libdeepspeech.so $ENV{CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libdeepspeech.so )

target_link_libraries( deepspeech-jni ${deepspeech-lib} )